# 目录
* /MT /MD

# 内容
## /MT /MD
来源：https://blog.csdn.net/guyue35/article/details/51198819

### 各个设置选项代表的含义
|编译选项|包含|静态链接的lib|说明|
|:-:|:-:|:-:|:-|
|/MT|_MT|LIBCMT.lib|libcmt是静态库|
|/MTd|_MT _DEBUG|LIBCMTD.lib|libcmt是静态库|
|/MD|_MT _DLL|MSVCRT.lib|依赖MSVCRT**.dll|
|/MDd|_MT _DLL _DEBUG|MSVCRTD.lib|依赖MSVCRT**.dll|

### 选/MD的原因
1. 程序就不需要静态链接运行时库，可以减小软件的大小；
2. 所有的模块都采用/MD，使用的是同一个堆，不存在A堆申请，B堆释放的问题。

### 选/MT的原因
1. 有些系统可能没有程序所需要版本的运行时库，程序必须把运行时库静态链接上；
2. 减少模块对外界的依赖。

### /MT需要解决的堆空间释放问题
不同的模块各自有一份C运行时库代码、或者根本没有C运行时库，导致了各个模块会有各自的堆。如果在A堆中申请空间，到B堆中释放就会有崩溃，在模块A申请的空间，必须在模块A中释放。

附录的DLL以及DLLUser代码，以STL的string为例，通过修改编译选项验证了这个问题。string在赋值的时候需要释放掉原来的内存空间，然后再申请新的内存空间存储新的内容，如果跨模块了，释放的时候就存在“A模块申请B模块释放”的问题，导致程序崩溃。

### /MD需要统一版本
多个dll被一个exe LoadLibrary加载，如果这些dll使用的运行时库是不同的，那么可能出现加载失败，原因可能是旧版本的运行时库已经在了，而某个dll它需要的是新版本的运行时库，旧版本不符合要求。
